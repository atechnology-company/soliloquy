load("//build:v_rules.bzl", "v_library", "v_object")
# Rust integration commented out until shims are fully implemented
# load("@rules_rust//rust:defs.bzl", "rust_library", "rust_test")

package(default_visibility = ["//visibility:public"])

# V IPC library compiled from translated Zircon sources
v_library(
    name = "zircon_v_ipc",
    srcs = [
        "handle.v",
        "message_packet.v",
        "channel.v",
        "channel_v2.v",
        "ipc_types.v",
        "port.v",
    ],
)

# V IPC smoke test
v_object(
    name = "ipc_smoke",
    srcs = ["ipc_smoke.v"],
    output_name = "ipc_smoke",
)

# TODO: Enable Rust shims when fully implemented
# rust_library(
#     name = "zircon_v_ipc_shims",
#     srcs = ["shims/mod.rs"],
#     edition = "2021",
#     deps = [
#         ":zircon_v_ipc",
#     ],
# )
# 
# rust_test(
#     name = "ipc_shims_test",
#     crate = ":zircon_v_ipc_shims",
# )
